SELECT s.PROVINCE, s.MSG, s.shangxing, d.dinggou
FROM
 (SELECT m.PROVINCE, MSG, count(DISTINCT r.SENDER) shangxing FROM R200904 r, MOBILENODIST m
  WHERE substr(r.SENDER,1,7)=m.BEGINNO
  AND DEALTIME >= '20171207000000'
  AND DEALTIME < '20171208000000'
  AND MSG IN ('FL1', 'FL2', upper('fl3'))
  GROUP BY m.PROVINCE,MSG
  ORDER BY m.PROVINCE) s,
 (SELECT  m.PROVINCE, MSG, count(DISTINCT r.SENDER) dinggou
  FROM R200904 r, MOBILENODIST m,NEW_WIRELESS_SUBSCRIPTION n
  WHERE substr(r.SENDER,1,7)=m.BEGINNO AND DEALTIME >= '20171207000000'
  AND DEALTIME < '20171208000000' AND r.SENDER=n.MOBILE_SN AND n.SERVCODE='FLBK_MMS'
  --AND n.MOBILE_MODIFY_TIME > to_date('2017-10-01', 'yyyy-mm-dd')
  --AND (n.MOBILE_MODIFY_TIME - n.MOBILE_SUB_TIME)*24 > 72
  AND n.MOBILE_SUB_TIME >= to_date('2017-12-07', 'yyyy-mm-dd') AND n.MOBILE_SUB_TIME < to_date('2017-12-08', 'yyyy-mm-dd')
  AND MSG IN ('FL1', 'FL2', 'FL3')
  GROUP BY m.PROVINCE,MSG
  ORDER BY m.PROVINCE) d
WHERE
 s.PROVINCE=d.PROVINCE(+)
 AND s.MSG=d.MSG(+)
ORDER BY s.PROVINCE,s.MSG
